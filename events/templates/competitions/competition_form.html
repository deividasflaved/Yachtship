{% extends 'marea/layout.html' %}
{% load static %}
{% block content %}

{% if formset %}

<script async type="module">
    import {DynamicForm} from '{% static 'js/DynamicForm.js' %}';

    new DynamicForm('{{ formset.prefix }}');
</script>

<form method="post">
    {% csrf_token %}
    <table id="id_forms_table" class="table table-hover shadow-lg">
        {# TODO: May need check for formset.can_delete #}

        {{ formset.management_form }}
        
        {% for form in formset %}
        {% if forloop.first %}
        <thead>
            <tr>
                {% for field in form.visible_fields %}
                <th scope="col">{{ field.label|capfirst }}</th>
                {% endfor %}
            </tr>
        </thead>
        {% endif %}
        {% endfor %}
        <tbody id="competitions-form-container">
            {% for form in formset %}
            <tr id="{{ form.prefix }}-row" class="dynamic-form">
                {% for hidden_field in form.hidden_fields %}
                    {{ hidden_field }}
                {% endfor %}


                <td>{{ form.title }}</td>
                <td>{{ form.start_date }}</td>
                <td>{{ form.referee }}</td>
                <td class="delete">{{ form.DELETE }}</td>
                <td>
                    <button id="remove-{{ form.prefix }}-row" 
                    class="btn btn-indeform-danger btn-block shadow-lg"
                    type="button">
                    Delete entry
                </button> 
                </td>
                {% if form.errors %}
                <td colspan="5">{{ form.errors.as_ul }} </td>
                {% endif %}
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">There are no competitions.</td>
            </tr>
            {% endfor %}
        </tbody>
        <tr>
            <td colspan="4"><a id="addForm" href="javascript:void(0)" class="add-row">ADD</a></td>
        </tr>
    </table>
    <button class="btn btn-indeform btn-block shadow-lg mt-5" type="submit">
        Update
    </button>
</form>
{% else %}
<tr>
    <td colspan="4">There are no competitions.</td>
</tr>
{% endif %}
<template id='competitions-template'>
    <tr id="competitions-__prefix__-row" bgcolor="DarkSlateGray">
        <td>{{ formset.empty_form.title }}</td>
        <td>{{ formset.empty_form.start_date }}</td>
        <td>{{ formset.empty_form.referee }}</td>
        <td class="delete">{{ formset.empty_form.DELETE }}</td>
        <td>
            <button id="remove-competitions-__prefix__-row"
            class="btn btn-indeform-danger btn-block shadow-lg"
            type="button">
                Delete entry
            </button> 
        </td>
    </tr>
</template>


{% endblock content %}